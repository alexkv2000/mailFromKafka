package kvo.separat.kafkaSender;

import kvo.separat.kafkaSender.message.Message;
import kvo.separat.kafkaSender.message.MessageBuilder;
import kvo.separat.kafkaSender.producer.KafkaProducerFactory;
import kvo.separat.kafkaSender.producer.MessageSender;
import kvo.separat.kafkaSender.producer.Producer;

import java.time.LocalTime;
import java.time.format.DateTimeFormatter;
import java.util.List;

public class SendMessBin {
    static final int count = 2;

    public static void main(String[] args) {
        String startDate = LocalTime.now().format(DateTimeFormatter.ofPattern("HH:mm:ss"));

        // Конфигурация Kafka
        KafkaProducerFactory producerFactory = new KafkaProducerFactory("172.18.8.60:9092,172.18.2.198:9092");
        Producer producer = producerFactory.createProducer();

        // Создание отправителя сообщений
        MessageSender messageSender = new MessageSender(producer);

        // Параметры сообщений
        String topic = "topicDVMessage";
        String recipient = "KvochkinAY@itsnn.ru";
        String recipientCC = null;
        //recipientCC = "AlexKv2000@mail.ru";

        List<String> urls = List.of(
                "\"Печатная форма1.pdf\" : \"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\""

        );

        // Отправка сообщений
        for (int i = 0; i < count; i++) {
            MessageBuilder messageBuilder = MessageBuilder.builder()
                    .to(recipient)
                    // .toCC(recipientCC)
                    .caption(String.format("%s %d: %s ", "Потоков 20: Тема сообщения ", i, LocalTime.now().format(DateTimeFormatter.ofPattern("HH:mm:ss"))))
                    .body(String.format("%s : %d %s", "Тело сообщения", i, "сообщение"))
                    .urls(urls)
                    .uuid();

            Message message = messageBuilder.build();

            messageSender.sendMessage(topic, message);
        }

        // Закрытие producer
        producer.close();

        System.out.println("Дата старта    : " + startDate + "\nДата окончания : " + LocalTime.now().format(DateTimeFormatter.ofPattern("HH:mm:ss")));
    }
}